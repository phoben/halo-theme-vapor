<!DOCTYPE html>
<html
  xmlns:th="https://www.thymeleaf.org"
  th:replace="~{modules/layout :: html (content = ~{::content},page_js = ~{::page_js},_title = ${title},_head = ~{::head})}"
>
  <th:block th:fragment="content">
    <div class="relative z-[2] mt-32 sm:px-8 lg:mt-48">
      <div class="mx-auto max-w-7xl lg:px-8">
        <div class="relative px-4 md:px-8">
          <header class="fade-before relative z-[2] max-w-2xl">
            <h1 class="font-slogan text-4xl font-bold tracking-tight text-zinc-800 sm:text-5xl dark:text-zinc-100">
              [[${title}]]
            </h1>
            <p class="my-6 text-base text-zinc-600 dark:text-zinc-400">
              <span style="display: inline-block; vertical-align: top; text-decoration: inherit; text-wrap: balance">
                [[${theme.config.custom.moments_description}]]
              </span>
            </p>
          </header>
          <main>
            <div class="mb-8">
              <nav class="flex flex-wrap gap-4" aria-label="Tabs">
                <a
                  th:href="@{/moments}"
                  class="rounded-full bg-zinc-400 px-3 py-1.5 text-sm font-medium text-zinc-500 transition-colors dark:bg-zinc-800 dark:text-zinc-400"
                  th:classappend="${#lists.isEmpty(param.tag) ? '!bg-zinc-800 !text-zinc-200 dark:!bg-zinc-200 dark:!text-zinc-800' : ''}"
                >
                  全部
                </a>
                <a
                  th:each="tag : ${tags}"
                  th:href="@{|?tag=${tag.name}|}"
                  class="rounded-full bg-zinc-200 px-3 py-1.5 text-sm font-medium text-zinc-600 transition-colors dark:bg-zinc-800 dark:text-zinc-400"
                  th:classappend="${#lists.contains(param.tag, tag.name) ? '!bg-zinc-800 !text-zinc-200 dark:!bg-zinc-200 dark:!text-zinc-800' : ''}"
                >
                  <span th:text="|#${tag.name}|"></span>
                  <sup th:text="${tag.momentCount}"></sup>
                </a>
              </nav>
            </div>
            <th:block th:if="${moments.total == 0}">
              <div class="fade-before relative z-[2] mx-auto my-16 max-w-md">
                <div class="relative rounded-2xl border border-zinc-100 p-6 transition-opacity dark:border-zinc-700/40">
                  <h2 class="flex items-center text-sm font-semibold text-zinc-900 dark:text-zinc-100">
                    <i class="iconfont icon-tishi"></i>
                    <span class="ml-2">暂时没有发布瞬间</span>
                  </h2>
                  <p class="mt-2 text-xs text-zinc-600 md:text-sm dark:text-zinc-400">
                    换个地方再继续搜索吧，获取你会在其他地方找到答案。
                  </p>
                </div>
              </div>
            </th:block>
            <ul th:else class="moments-list">
              <th:block
                th:each="moment : ${moments.items}"
                th:attr="x-data=|{name:'${moment.metadata.name}',showComment:false}|"
                th:with="content=${moment.spec.content}"
              >
                <li
                  class="moments-item fade-before list-none rounded-2xl border border-zinc-200 bg-gradient-to-b from-zinc-50/50 to-white/70 dark:border-zinc-700/40 dark:from-zinc-900/70 dark:to-zinc-800/60"
                >
                  <span class="flex w-full flex-col items-start gap-1 !p-4">
                    <div
                      class="-mt-2 flex w-full items-center justify-between gap-2 border-b border-dashed border-zinc-200 pb-2 dark:border-zinc-700/40"
                    >
                      <div class="inline-flex items-center text-sm text-zinc-600 dark:text-zinc-400">
                        <svg
                          width="1em"
                          height="1em"
                          viewBox="0 0 24 24"
                          fill="none"
                          xmlns="http://www.w3.org/2000/svg"
                        >
                          <path
                            d="M8 2V4.12777M8 6V4.12777M16 2V4.12777M16 6V4.12777M20.9597 10C21 10.7878 21 11.7554 21 13C21 15.7956 21 17.1935 20.5433 18.2961C19.9343 19.7663 18.7663 20.9343 17.2961 21.5433C16.1935 22 14.7956 22 12 22C9.20435 22 7.80653 22 6.7039 21.5433C5.23373 20.9343 4.06569 19.7663 3.45672 18.2961C3 17.1935 3 15.7956 3 13C3 11.7554 3 10.7878 3.0403 10M20.9597 10C20.9095 9.01824 20.7967 8.31564 20.5433 7.7039C19.9343 6.23373 18.7663 5.06569 17.2961 4.45672C16.9146 4.29871 16.4978 4.19536 16 4.12777M20.9597 10L3.0403 10M3.0403 10C3.09052 9.01824 3.20333 8.31564 3.45672 7.7039C4.06569 6.23373 5.23373 5.06569 6.7039 4.45672C7.08538 4.29871 7.50219 4.19536 8 4.12777M8 4.12777C8.94106 4 10.1716 4 12 4C13.8284 4 15.0589 4 16 4.12777"
                            stroke="currentColor"
                            stroke-width="2"
                            stroke-linecap="round"
                            stroke-linejoin="round"
                          ></path>
                        </svg>
                        <span class="ml-1" th:text="${#dates.format(moment.spec.releaseTime,'yyyy/MM/dd')}"> </span>
                      </div>
                      <img
                        th:src="${moment.owner.avatar ?: #theme.assets('/images/default-avatar.svg')}"
                        th:title="${moment.owner.displayName}"
                        th:alt="${moment.owner.displayName}"
                        class="size-5 rounded-full"
                      />
                    </div>
                    <div class="w-full">
                      <div
                        th:utext="${content.html}"
                        class="prose-moments prose break-words text-[14px] leading-[1.6] dark:prose-invert"
                      ></div>
                      <div
                        th:unless="${#lists.isEmpty(moment.spec.content.medium)}"
                        th:with="content = ${moment.spec.content},size = ${#lists.size(content.medium)}"
                        class="moment-media mt-2 w-full"
                      >
                        <th:block
                          th:replace="~{modules/widgets/gallery :: gallery(size = ${size},medium=${content.medium})}"
                        ></th:block>
                      </div>
                    </div>
                  </span>
                </li>
              </th:block>
            </ul>

            <th:block th:replace="~{modules/widgets/pagination :: page('/moments',${moments})}"></th:block>
          </main>
        </div>
      </div>
    </div>
  </th:block>

  <th:block th:fragment="page_js">
    <th:block th:replace="~{modules/widgets/fancy}"></th:block>
  </th:block>
</html>
